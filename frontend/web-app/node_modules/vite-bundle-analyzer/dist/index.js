"use strict";let e;Object.defineProperty(exports,"__esModule",{value:!0});var t,n=require("path"),r=require("os"),i=require("child_process"),o=require("zlib"),s=require("util"),l=require("fs"),u=require("http"),a=require("net"),c={exports:{}};Object.defineProperty(c.exports,"__esModule",{value:!0});const{round:d,floor:f,max:p}=Math,h=e=>{let[,t]=/([a-f\d]{3,6})/i.exec(e)||[],n=t?t.length:0;if(3===n)t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2];else if(6!==n)return[0,0,0];let r=parseInt(t,16);return[r>>16&255,r>>8&255,255&r]},m=(e,t,n)=>e===t&&t===n?e<8?16:e>248?231:d((e-8)/247*24)+232:16+36*d(e/51)+6*d(t/51)+d(n/51),g=e=>{let t,n,r,i,o,s;return e<8?30+e:e<16?e-8+90:(e>=232?t=n=r=(10*(e-232)+8)/255:(s=(e-=16)%36,t=f(e/36)/5,n=f(s/6)/5,r=s%6/5),0==(i=2*p(t,n,r))?30:(o=30+(d(r)<<2|d(n)<<1|d(t)),2===i?o+60:o))},y=(e,t,n)=>g(m(e,t,n)),w=(e=>{let t=e=>!!u.find(t=>e.test(t)),n=globalThis,r=n.Deno,i=null!=r,o=n.process||r||{},s=o.stdout,l="win32"===(i?r.build.os:o.platform),u=o.argv||o.args||[],a=o.env||{},c=-1;if(i)try{a=a.toObject()}catch(e){c=0}let d="FORCE_COLOR",f=a[d],p=parseInt(f),h="false"===f?0:isNaN(p)?3:p,m="NO_COLOR"in a||0===h||t(/^-{1,2}(no-color|color=(false|never))$/),g=d in a&&h||t(/^-{1,2}color=?(true|always)?$/),y=(a.NEXT_RUNTIME||"").indexOf("edge")>-1||"PM2_HOME"in a&&"pm_id"in a||(i?r.isatty(1):s&&"isTTY"in s);return m?0:(c<0&&(c=((e,t,n)=>{let{TERM:r,COLORTERM:i}=e;return"TF_BUILD"in e?1:"TEAMCITY_VERSION"in e?2:"CI"in e?["GITHUB_ACTIONS","GITEA_ACTIONS"].some(t=>t in e)?3:1:!t||/-mono|dumb/i.test(r)?0:n||"truecolor"===i||"24bit"===i||"xterm-kitty"===r?3:/-256(colou?r)?$/i.test(r)?2:/^screen|^tmux|^xterm|^vt[1-5][0-9]([0-9])?|^ansi|color|cygwin|linux|mintty|rxvt/i.test(r)?1:3})(a,y,l)),g&&0===c?3:c)})(),S=w>0,x={open:"",close:""},b=S?(e,t)=>({open:`[${e}m`,close:`[${t}m`}):()=>x,_=e=>(t,n,r)=>e(m(t,n,r)),z=e=>t=>{let[n,r,i]=h(t);return e(n,r,i)};let O=e=>b(`38;5;${e}`,39),v=e=>b(`48;5;${e}`,49),k=(e,t,n)=>b(`38;2;${e};${t};${n}`,39),M=(e,t,n)=>b(`48;2;${e};${t};${n}`,49);1===w?(O=e=>b(g(e),39),v=e=>b(g(e)+10,49),k=(e,t,n)=>b(y(e,t,n),39),M=(e,t,n)=>b(y(e,t,n)+10,49)):2===w&&(k=_(O),M=_(v));let $,j,C={ansi256:O,bgAnsi256:v,fg:O,bg:v,rgb:k,bgRgb:M,hex:z(k),bgHex:z(M),visible:x,reset:b(0,0),inverse:b(7,27),hidden:b(8,28),bold:b(1,22),dim:b(2,22),italic:b(3,23),underline:b(4,24),strikethrough:b(9,29),strike:b(9,29),grey:b(90,39),gray:b(90,39),bgGrey:b(100,49),bgGray:b(100,49)},E="Bright",I=30;for($ of["black","red","green","yellow","blue","magenta","cyan","white"])j="bg"+$[0].toUpperCase()+$.slice(1),C[$]=b(I,39),C[$+E]=b(I+60,39),C[j]=b(I+10,49),C[j+E]=b(I+70,49),I++;const{defineProperty:N,defineProperties:P,setPrototypeOf:T}=Object,B=/[Â›][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,A=/(\r?\n)/g,R={},F=({_p:t},{open:n,close:r})=>{let i=(e,...t)=>{if(!e)return"";let n=i._p,{_a:r,_b:o}=n,s=null!=e.raw?String.raw(e,...t):""+e;if(s.includes("\x1b"))for(;null!=n;){let e=n.close,t=e.length;if(t){let r,i=0,o="";for(;~(r=s.indexOf(e,i));)o+=s.slice(i,r)+n.open,i=r+t;i&&(s=o+s.slice(i))}n=n._p}return s.includes("\n")&&(s=s.replace(A,o+"$1"+r)),r+s+o},o=n,s=r;return null!=t&&(o=t._a+n,s=r+t._b),T(i,e),i._p={open:n,close:r,_a:o,_b:s,_p:t},i.open=o,i.close=s,i},L=function(){let t=e=>""+e;return t.isSupported=()=>S,t.strip=e=>e.replace(B,""),t.extend=n=>{for(let e in n){let t=n[e],r=typeof t,i="string"===r?k(...h(t)):t;R[e]="function"===r?{get(){return(...e)=>F(this,t(...e))}}:{get(){let t=F(this,i);return N(this,e,{value:t}),t}}}T(t,e=P({},R))},t.extend(C),t},D=new L;c.exports=D,c.exports.Ansis=L;var q=(t=c.exports)&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;const U=l.promises,W=new TextEncoder,G=s.promisify(o.gzip),J={level:o.constants.Z_DEFAULT_LEVEL},H=Y(n.join(__dirname,"client")),K=Y(n.join(H,"assets"));function Y(e){return/^\\\\\?\\/.test(e)?e:e.replace(/\\/g,"/")}function Z(e){return"string"==typeof e?W.encode(e):e}async function V(e){let t=await Promise.all((await U.readdir(e)).map(t=>n.join(e,t))),r=0,i=[];for(;r!==t.length;){let e=t[r],o=await U.stat(e);if(o.isDirectory()){let r=await U.readdir(e);t.push(...r.map(t=>n.join(e,t)))}o.isFile()&&i.push(e),r++}return i}const X=process.env.DEBUG||process.env.ANALYZE_DEBUG?(...e)=>{console.log(q.hex("#5B45DE")("[vite:bundle-analyzer]"),...e)}:()=>{};function Q(e){let t="head"===e.injectTo?/([ \t]*)<\/head>/i:/([ \t]*)<\/body>/i;e.descriptors=Array.isArray(e.descriptors)?e.descriptors:[e.descriptors];let n=e.descriptors.map(e=>e.attrs&&e.attrs.length>0?`<${e.kind} ${e.attrs.join(" ")}>${e.text}</${e.kind}>`:`<${e.kind}>${e.text}</${e.kind}>`);return e.html.replace(t,e=>`${n.join("\n")}${e}`)}function ee(e,t){let{stringify:n}=JSON;return`var defaultSizes=${n(t)},analyzeModule=${n(e)};`}async function et(e,t){let r=await V(K),i=(await Promise.all(r.map(async e=>({fileType:n.extname(e).replace(".",""),content:await U.readFile(e,"utf8")})))).filter(e=>["js","css"].includes(e.fileType)),o=await U.readFile(n.join(H,"index.html"),"utf8");return o=Q({html:o=(o=(o=o.replace(/<script\b[^>]*>[\s\S]*?<\/script>/gi,"")).replace(/<link\b[^>]*rel="stylesheet"[^>]*>/gi,"")).replace(/<title>(.*?)<\/title>/,`<title>${t.title}</title>`),injectTo:"head",descriptors:i.map(({fileType:e,content:t})=>({kind:"js"===e?"script":"style",text:t,attrs:"js"===e?['type="module"']:[]}))}),o=Q({html:o,injectTo:"body",descriptors:{kind:"script",text:ee(e,t.mode)}})}const en=["pnpm-workspace.yaml","lerna.json"];function er(e,t=function e(t,r=t){if(function(e){let t=n.join(e,"package.json");return l.existsSync(t)}(t))return t;let i=n.dirname(t);return i&&i!==t?e(i,r):r}(e)){if(en.some(t=>l.existsSync(n.join(e,t)))||function(e){let t=n.join(e,"package.json");if(!function(e){if(!function(e){try{return l.statSync(e,{throwIfNoEntry:!1})}catch{}}(e))return!1;try{return l.accessSync(e,l.constants.R_OK),!0}catch{return!1}}(t))return!1;try{return!!(JSON.parse(l.readFileSync(t,"utf-8"))||{}).workspaces}catch{return!1}}(e))return e;let r=n.dirname(e);return r&&r!==e?er(r,t):t}class ei{kind;meta;filename;children;groups;isEndOfPath;constructor(e){this.kind=e?.kind||"stat",this.meta=e?.meta||{},this.filename=e?.filename||"",this.children=new Map,this.groups=[],this.isEndOfPath=!1}}class eo{root;constructor(e){this.root=new ei(e)}insert(e,t){let n=this.root,r=e.split("/").filter(Boolean),i="";for(let e of r)i=i?`${i}/${e}`:e,n.children.has(e)||n.children.set(e,new ei({...t})),(n=n.children.get(e)).filename=i;n.isEndOfPath=!0}mergePrefixSingleDirectory(e=this.root){for(let[t,n]of e.children.entries()){if(n.isEndOfPath)break;if(n.children.size>1){this.mergePrefixSingleDirectory(n);continue}for(let[r,i]of(e.children.delete(t),n.children.entries()))e.children.set(`${t}/${r}`,i),i.isEndOfPath||this.mergePrefixSingleDirectory(i)}}walk(e,t){if(e.children.size){for(let[n,r]of e.children.entries()){let i={...r.meta,label:n,groups:r.groups,filename:r.filename};if(r.isEndOfPath&&delete i.groups,t(i,e),this.walk(r,t),i.groups&&i.groups.length)switch(e.kind){case"stat":i.statSize=i.groups.reduce((e,t)=>e+t.statSize,0);break;case"source":{let e=i.groups.reduce((e,t)=>(e.parsedSize+=t.parsedSize,e.gzipSize+=t.gzipSize,e),{parsedSize:0,gzipSize:0});Object.assign(i,e)}}}e.children.clear()}}}const es="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",el=new Uint8Array(64),eu=new Uint8Array(128);for(let e=0;e<es.length;e++){let t=es.charCodeAt(e);el[e]=t,eu[t]=e}const ea="undefined"!=typeof TextDecoder?new TextDecoder:"undefined"!=typeof Buffer?{decode:e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString()}:{decode(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}};function ec(e,t,n,r){let i=0,o=0,s=0;do i|=(31&(s=eu[e.charCodeAt(t++)]))<<o,o+=5;while(32&s);let l=1&i;return i>>>=1,l&&(i=-2147483648|-i),n[r]+=i,t}function ed(e,t,n){return!(t>=n)&&44!==e.charCodeAt(t)}function ef(e,t){return e[0]-t[0]}function ep(e,t,n,r,i){let o=r[i],s=o-n[i];n[i]=o,s=s<0?-s<<1|1:s<<1;do{let n=31&s;(s>>>=5)>0&&(n|=32),e[t++]=el[n]}while(s>0);return t}const eh=/^[\w+.-]+:\/\//,em=/^([\w+.-]+:)\/\/([^@/#?]*@)?([^:/#?]*)(:\d+)?(\/[^#?]*)?(\?[^#]*)?(#.*)?/,eg=/^file:(?:\/\/((?![a-z]:)[^/#?]*)?)?(\/?[^#?]*)(\?[^#]*)?(#.*)?/i;function ey(e){return e.startsWith("/")}function ew(e){return/^[.?#]/.test(e)}function eS(e){let t=em.exec(e);return ex(t[1],t[2]||"",t[3],t[4]||"",t[5]||"/",t[6]||"",t[7]||"")}function ex(e,t,n,r,i,o,s){return{scheme:e,user:t,host:n,port:r,path:i,query:o,hash:s,type:7}}function eb(e){if(e.startsWith("//")){let t=eS("http:"+e);return t.scheme="",t.type=6,t}if(ey(e)){let t=eS("http://foo.com"+e);return t.scheme="",t.host="",t.type=5,t}if(e.startsWith("file:"))return function(e){let t=eg.exec(e),n=t[2];return ex("file:","",t[1]||"","",ey(n)?n:"/"+n,t[3]||"",t[4]||"")}(e);if(eh.test(e))return eS(e);let t=eS("http://foo.com/"+e);return t.scheme="",t.host="",t.type=e?e.startsWith("?")?3:e.startsWith("#")?2:4:1,t}function e_(e,t){let n=t<=4,r=e.path.split("/"),i=1,o=0,s=!1;for(let e=1;e<r.length;e++){let t=r[e];if(!t){s=!0;continue}if(s=!1,"."!==t){if(".."===t){o?(s=!0,o--,i--):n&&(r[i++]=t);continue}r[i++]=t,o++}}let l="";for(let e=1;e<i;e++)l+="/"+r[e];l&&(!s||l.endsWith("/.."))||(l+="/"),e.path=l}function ez(e,t){return t&&!t.endsWith("/")&&(t+="/"),function(e,t){if(!e&&!t)return"";let n=eb(e),r=n.type;if(t&&7!==r){let e=eb(t),i=e.type;switch(r){case 1:n.hash=e.hash;case 2:n.query=e.query;case 3:case 4:e_(e,e.type),"/"===n.path?n.path=e.path:n.path=function(e){if(e.endsWith("/.."))return e;let t=e.lastIndexOf("/");return e.slice(0,t+1)}(e.path)+n.path;case 5:n.user=e.user,n.host=e.host,n.port=e.port;case 6:n.scheme=e.scheme}i>r&&(r=i)}e_(n,r);let i=n.query+n.hash;switch(r){case 2:case 3:return i;case 4:{let r=n.path.slice(1);if(!r)return i||".";if(ew(t||e)&&!ew(r))return"./"+r+i;return r+i}case 5:return n.path+i;default:return n.scheme+"//"+n.user+n.host+n.port+n.path+i}}(e,t)}function eO(e,t){for(let n=t;n<e.length;n++)if(!function(e){for(let t=1;t<e.length;t++)if(e[t][0]<e[t-1][0])return!1;return!0}(e[n]))return n;return e.length}function ev(e,t){return e[0]-t[0]}let ek=!1;function eM(e,t,n){for(let r=n+1;r<e.length&&e[r][0]===t;n=r++);return n}function e$(e,t,n){for(let r=n-1;r>=0&&e[r][0]===t;n=r--);return n}function ej(){return{lastKey:-1,lastNeedle:-1,lastIndex:-1}}function eC(e,t,n,r){let{lastKey:i,lastNeedle:o,lastIndex:s}=n,l=0,u=e.length-1;if(r===i){if(t===o)return ek=-1!==s&&e[s][0]===t,s;t>=o?l=-1===s?0:s:u=s}return n.lastKey=r,n.lastNeedle=t,n.lastIndex=function(e,t,n,r){for(;n<=r;){let i=n+(r-n>>1),o=e[i][0]-t;if(0===o)return ek=!0,i;o<0?n=i+1:r=i-1}return ek=!1,n-1}(e,t,l,u)}function eE(){return{__proto__:null}}const eI=function(e,t){let n=eN(e);if(!("sections"in n))return new eA(n,t);let r=[],i=[],o=[],s=[],l=[];return function e(t,n,r,i,o,s,l,u,a,c,d){let{sections:f}=t;for(let t=0;t<f.length;t++){let{map:p,offset:h}=f[t],m=c,g=d;if(t+1<f.length){let e=f[t+1].offset;(m=Math.min(c,u+e.line))===c?g=Math.min(d,a+e.column):m<c&&(g=a+e.column)}!function(t,n,r,i,o,s,l,u,a,c,d){let f=eN(t);if("sections"in f)return e(...arguments);let p=new eA(f,n),h=i.length,m=s.length,g=eR(p),{resolvedSources:y,sourcesContent:w,ignoreList:S}=p;if(eP(i,y),eP(s,p.names),w)eP(o,w);else for(let e=0;e<y.length;e++)o.push(null);if(S)for(let e=0;e<S.length;e++)l.push(S[e]+h);for(let e=0;e<g.length;e++){let t=u+e;if(t>c)return;let n=function(e,t){for(let n=e.length;n<=t;n++)e[n]=[];return e[t]}(r,t),i=0===e?a:0,o=g[e];for(let e=0;e<o.length;e++){let r=o[e],s=i+r[0];if(t===c&&s>=d)return;if(1===r.length){n.push([s]);continue}let l=h+r[1],u=r[2],a=r[3];n.push(4===r.length?[s,l,u,a]:[s,l,u,a,m+r[4]])}}}(p,n,r,i,o,s,l,u+h.line,a+h.column,m,g)}}(n,t,r,i,o,s,l,0,0,1/0,1/0),function(e,t){var n;let r=new eA((n=[],{version:e.version,file:e.file,names:e.names,sourceRoot:e.sourceRoot,sources:e.sources,sourcesContent:e.sourcesContent,mappings:n,ignoreList:e.ignoreList||e.x_google_ignoreList}),void 0);return r._decoded=e.mappings,r}({version:3,file:n.file,names:s,sources:i,sourcesContent:o,mappings:r,ignoreList:l})};function eN(e){return"string"==typeof e?JSON.parse(e):e}function eP(e,t){for(let n=0;n<t.length;n++)e.push(t[n])}const eT="`line` must be greater than 0 (lines start at line 1)",eB="`column` must be greater than or equal to 0 (columns start at column 0)";class eA{constructor(e,t){let n="string"==typeof e;if(!n&&e._decodedMemo)return e;let r=n?JSON.parse(e):e,{version:i,file:o,names:s,sourceRoot:l,sources:u,sourcesContent:a}=r;this.version=i,this.file=o,this.names=s||[],this.sourceRoot=l,this.sources=u,this.sourcesContent=a,this.ignoreList=r.ignoreList||r.x_google_ignoreList||void 0;let c=ez(l||"",function(e){if(!e)return"";let t=e.lastIndexOf("/");return e.slice(0,t+1)}(t));this.resolvedSources=u.map(e=>ez(e||"",c));let{mappings:d}=r;"string"==typeof d?(this._encoded=d,this._decoded=void 0):(this._encoded=void 0,this._decoded=function(e,t){let n=eO(e,0);if(n===e.length)return e;t||(e=e.slice());for(let i=n;i<e.length;i=eO(e,i+1)){var r;e[i]=(r=e[i],t||(r=r.slice()),r.sort(ev))}return e}(d,n)),this._decodedMemo=ej(),this._bySources=void 0,this._bySourceMemos=void 0}}function eR(e){return e._decoded||(e._decoded=function(e){let t=new Int32Array(5),n=[],r=0;do{let i=function(e,t){let n=e.indexOf(";",t);return -1===n?e.length:n}(e,r),o=[],s=!0,l=0;t[0]=0;for(let n=r;n<i;n++){let r;n=ec(e,n,t,0);let u=t[0];u<l&&(s=!1),l=u,ed(e,n,i)?(n=ec(e,n,t,1),n=ec(e,n,t,2),n=ec(e,n,t,3),ed(e,n,i)?(n=ec(e,n,t,4),r=[u,t[1],t[2],t[3],t[4]]):r=[u,t[1],t[2],t[3]]):r=[u],o.push(r)}s||function(e){e.sort(ef)}(o),n.push(o),r=i+1}while(r<=e.length);return n}(e._encoded))}function eF(e,t,n,r){return{source:e,line:t,column:n,name:r}}function eL(e,t){return{line:e,column:t}}function eD(e,t,n,r,i){let o=eC(e,r,t,n);return(ek?o=(-1===i?eM:e$)(e,r,o):-1===i&&o++,-1===o||o===e.length)?-1:o}function eq(e,t,n,r,i,o){if(--n<0)throw Error(eT);if(r<0)throw Error(eB);let{sources:s,resolvedSources:l}=e,u=s.indexOf(t);if(-1===u&&(u=l.indexOf(t)),-1===u)return o?[]:eL(null,null);let a=(e._bySources||(e._bySources=function(e,t){let n=t.map(eE);for(let r=0;r<e.length;r++){let i=e[r];for(let e=0;e<i.length;e++){let o=i[e];if(1===o.length)continue;let s=o[1],l=o[2],u=o[3],a=n[s],c=a[l]||(a[l]=[]),d=t[s],f=eM(c,u,eC(c,u,d,l));d.lastIndex=++f,function(e,t,n){for(let n=e.length;n>t;n--)e[n]=e[n-1];e[t]=n}(c,f,[u,r,o[0]])}}return n}(eR(e),e._bySourceMemos=s.map(ej))))[u][n];if(null==a)return o?[]:eL(null,null);let c=e._bySourceMemos[u];if(o)return function(e,t,n,r,i){let o=eD(e,t,n,r,1);if(!ek&&-1===i&&o++,-1===o||o===e.length)return[];let s=ek?r:e[o][0];ek||(o=e$(e,s,o));let l=eM(e,s,o),u=[];for(;o<=l;o++){let t=e[o];u.push(eL(t[1]+1,t[2]))}return u}(a,c,n,r,i);let d=eD(a,c,n,r,i);if(-1===d)return eL(null,null);let f=a[d];return eL(f[1]+1,f[2])}class eU{constructor(e,t){let n=this._map=new eI(e,t);this.file=n.file,this.names=n.names,this.sourceRoot=n.sourceRoot,this.sources=n.resolvedSources,this.sourcesContent=n.sourcesContent,this.version=n.version}static fromSourceMap(e,t){return e.toDecodedMap?new eU(e.toDecodedMap(),t):new eU(e.toJSON(),t)}get mappings(){var e,t;return null!==(t=(e=this._map)._encoded)&&void 0!==t?t:e._encoded=function(e){let t=new Int32Array(5),n=new Uint8Array(16384),r=n.subarray(0,16348),i=0,o="";for(let s=0;s<e.length;s++){let l=e[s];if(s>0&&(16384===i&&(o+=ea.decode(n),i=0),n[i++]=59),0!==l.length){t[0]=0;for(let e=0;e<l.length;e++){let s=l[e];i>16348&&(o+=ea.decode(r),n.copyWithin(0,16348,i),i-=16348),e>0&&(n[i++]=44),i=ep(n,i,t,s,0),1!==s.length&&(i=ep(n,i,t,s,1),i=ep(n,i,t,s,2),i=ep(n,i,t,s,3),4!==s.length&&(i=ep(n,i,t,s,4)))}}}return o+ea.decode(n.subarray(0,i))}(e._decoded)}originalPositionFor(e){return function(e,t){let{line:n,column:r,bias:i}=t;if(--n<0)throw Error(eT);if(r<0)throw Error(eB);let o=eR(e);if(n>=o.length)return eF(null,null,null,null);let s=o[n],l=eD(s,e._decodedMemo,n,r,i||1);if(-1===l)return eF(null,null,null,null);let u=s[l];if(1===u.length)return eF(null,null,null,null);let{names:a,resolvedSources:c}=e;return eF(c[u[1]],u[2]+1,u[3],5===u.length?a[u[4]]:null)}(this._map,e)}generatedPositionFor(e){return function(e,t){let{source:n,line:r,column:i,bias:o}=t;return eq(e,n,r,i,o||1,!1)}(this._map,e)}allGeneratedPositionsFor(e){return function(e,t){let{source:n,line:r,column:i,bias:o}=t;return eq(e,n,r,i,o||-1,!0)}(this._map,e)}hasContentsOfAllSources(){if(!this.sourcesContent||this.sourcesContent.length!==this.sources.length)return!1;for(let e of this.sourcesContent)if(null==e)return!1;return!0}sourceContentFor(e,t){let n=function(e,t){let{sourcesContent:n}=e;if(null==n)return null;let r=function(e,t){let{sources:n,resolvedSources:r}=e,i=n.indexOf(t);return -1===i&&(i=r.indexOf(t)),i}(e,t);return -1===r?null:n[r]}(this._map,e);if(null!=n)return n;if(t)return null;throw Error(`"${e}" is not in the SourceMap.`)}eachMapping(e,t){!function(e,t){let n=eR(e),{names:r,resolvedSources:i}=e;for(let e=0;e<n.length;e++){let o=n[e];for(let n=0;n<o.length;n++){let s=o[n],l=e+1,u=s[0],a=null,c=null,d=null,f=null;1!==s.length&&(a=i[s[1]],c=s[2]+1,d=s[3]),5===s.length&&(f=r[s[4]]),t({generatedLine:l,generatedColumn:u,source:a,originalLine:c,originalColumn:d,name:f})}}}(this._map,t?e.bind(t):e)}destroy(){}}class eW extends eU{constructor(e){super(JSON.parse(e),"")}}const eG=new TextDecoder,eJ=[".mjs",".js",".cjs",".ts",".tsx",".vue",".svelte",".md",".mdx"],eH=process.cwd();function eK(e,t=eH){let r=function(e,t=eH){return(e=Y(e)).replace(t,"").replace(/\0/,"")}(e,t);return n.isAbsolute(r)?r.replace("/",""):r}class eY{originalId;filename;label;parsedSize;mapSize;statSize;gzipSize;source;stats;imports;isAsset;isEntry;constructor(e){this.originalId=e,this.filename=e,this.label=e,this.parsedSize=0,this.statSize=0,this.gzipSize=0,this.mapSize=0,this.source=[],this.stats=[],this.imports=new Set,this.isAsset=!0,this.isEntry=!1}addImports(...e){e.forEach(e=>this.imports.add(e))}async setup(e,t,r,i){let{imports:o,dynamicImports:s,map:l,moduleIds:u}=e;this.addImports(...o,...s),this.mapSize=l.length,this.isEntry=e.isEntry;let a=u.length?u.reduce((e,r)=>{let i=t.getModuleInfo(r);return i&&i.code&&(eJ.includes(n.extname(i.id))||i.id.startsWith("\0"))&&e.push({id:i.id,code:i.code}),e},[]):function(e){let t=new eW(e),n=t.sources.reduce((e,n)=>{if(n){let r=t.sourceContentFor(n,!0);r&&e.push({id:n,code:r})}return e},[]);return t.destroy(),n}(l),c=new eo({meta:{statSize:0}}),d=new eo({kind:"source",meta:{gzipSize:0,parsedSize:0}});for(let e of a){if("."===e.id[0]){let n=await t.resolve(e.id,this.originalId);if(!n)continue;e.id=n.id}let n=Z(e.code).byteLength;this.statSize+=n,c.insert(eK(e.id,i),{kind:"stat",meta:{statSize:n}})}X("Start analyze stats: module '"+this.originalId+"' find "+a.length+" modules");let f=function(e,t,n){let r=new eW(t),i={},o=1,s=0,l=eG.decode(e);for(let e=0;e<l.length;e++,s++){let{source:t}=r.originalPositionFor({line:o,column:s});if(null!=t){let r=n(t),o=l[e];r in i||(i[r]=""),i[r]+=o}"\n"===l[e]&&(o+=1,s=-1)}return r.destroy(),i}(e.code,l,e=>{let t=n.relative(i,e);return n.join(i,t)}),p=0;for(let e in f){if(!eJ.includes(n.extname(e)))continue;let t=Z(f[e]),{byteLength:o}=await r(t),s=t.byteLength;d.insert(eK(e,i),{kind:"source",meta:{gzipSize:o,parsedSize:s}}),p++}for(let e of(X("Start analyze source: module '"+this.originalId+"' find "+p+" chunks"),c.mergePrefixSingleDirectory(),c.walk(c.root,(e,t)=>t.groups.push(e)),d.mergePrefixSingleDirectory(),d.walk(d.root,(e,t)=>t.groups.push(e)),this.stats=c.root.groups,this.source=d.root.groups,this.source))this.gzipSize+=e.gzipSize,this.parsedSize+=e.parsedSize}}class eZ{compress;modules;workspaceRoot;pluginContext;chunks;constructor(e){this.compress=function(e={}){return e=Object.assign(J,e),t=>G(t,e)}(e),this.modules=[],this.pluginContext=null,this.chunks={},this.workspaceRoot=process.cwd()}installPluginContext(e){this.pluginContext||(this.pluginContext=e)}setupRollupChunks(e){this.chunks=e}async addModule(e,t){let n=function(e,t,n){let r={},i="chunk"===e.type;return r.code=Z(i?e.code:e.source),r.map=function(e,t,n){if(t in n)return n[t].source;throw Error(`[analyzer error]: Missing sourcemap for ${e}.`)}(e.fileName,n,t),r.imports=i?e.imports:[],r.dynamicImports=i?e.dynamicImports:[],r.moduleIds=i?e.moduleIds:[],r.filename=e.fileName,r.isEntry=!!i&&e.isEntry,r}(e,this.chunks,t),r=new eY(n.filename);await r.setup(n,this.pluginContext,this.compress,this.workspaceRoot),this.modules.push(r)}processModule(){return this.modules.map(e=>{let{originalId:t,imports:n,...r}=e;return{...r,imports:[...n]}})}}const eV={".js":"application/javascript",".css":"text/css"};async function eX(e){let t=()=>Math.floor(64512*Math.random())+1024,n=async e=>new Promise(t=>{let n=a.createServer();n.once("error",e=>{"EADDRINUSE"===e.code?t(!1):t(!0)}),n.once("listening",()=>{n.close(()=>{t(!0)})}),n.listen(e,"localhost")});if(0===e){let e=!1,r=0;for(;!e;)r=t(),e=await n(r);return r}let r=await n(e);if(r)return e;{let t=e+1;for(;;){if(r=await n(t))return t;t++}}}async function eQ(e=0){let t=u.createServer(),r=await eX(e);return t.listen(r,()=>{console.log(`server run on http://localhost:${r}`)}),{setup:(e,r)=>{t.on("request",function(e,t){let r=new Map;return function(i,o){let s=n.join(H,i.url);if(r.has(s)){let{data:e,mimeType:t}=r.get(s);o.writeHead(200,{"Content-Type":t}),o.end(e);return}if("/"===i.url){o.setHeader("Content-Type","text/html; charset=utf8;");let i=l.readFileSync(n.join(H,"index.html"),"utf8");i=Q({html:i=i.replace(/<title>(.*?)<\/title>/,`<title>${e.title}</title>`),injectTo:"body",descriptors:{kind:"script",text:ee(t,e.mode)}}),o.end(i),r.set(s,{data:i,mimeType:"text/html; charset=utf8;"});return}l.readFile(s,(e,t)=>{if(e)o.statusCode=404,o.end("Not Found");else{let e=eV[n.extname(s)]||"application/octet-stream";o.writeHead(200,{"Content-Type":e}),o.end(t),r.set(s,{data:t,mimeType:e})}})}}(r,e))},get port(){return r}}}const e0=!!process.env.CI,e1={analyzerMode:"server",summary:!0},e2=e=>q.dim(q.bold(e+"")),e3=e=>e2(function(e){if(!e)return"0 Bytes";let t=parseInt(`${Math.floor(Math.log(e)/Math.log(1024))}`);return(e/(1<<10*t)).toFixed(2)+" "+["Bytes","KB","MB","GB","TB"][t]}(e)),e4=e=>{let t=e.length,n=e.reduce((e,t)=>(e.gzip+=t.gzipSize,e.parsed+=t.parsedSize,e.map+=t.mapSize,e),{gzip:0,parsed:0,map:0}),r=[n.gzip&&`gzip: ${e3(n.gzip)}`,n.map&&`map: ${e3(n.map)}`].filter(Boolean).join(" | ");return`${e2(t)} chunks of ${e3(n.parsed)} ${r?`(${r})`:""}`};function e8(e){let t;let{reportTitle:o="vite-bundle-analyzer"}=e=e?{...e1,...e}:e1,s=new eZ(e?.gzipOptions),l={previousSourcemapOption:!1,hasSetSourcemapOption:!1,analyzerModule:s},u=process.cwd(),a=!0,c=process.cwd();return{name:"vite-bundle-anlyzer",apply:"build",enforce:"post",api:{store:l},configResolved(r){if(u=n.resolve(r.root,r.build.outDir??""),t=r.logger,c=er(r.root),s.workspaceRoot=c,e.summary){let e=r.plugins.find(e=>"vite:reporter"===e.name);if(a=!!e?.writeBundle,e?.writeBundle){let n="function"==typeof e.writeBundle?e.writeBundle:e.writeBundle?.handler,r=async function(...e){await n?.apply(this,e),t.info(e4(s.modules))};"function"!=typeof e.writeBundle?e.writeBundle.handler=r:e.writeBundle=r}}l.hasSetSourcemapOption||(l.hasSetSourcemapOption=!0,r.build?.sourcemap&&(l.previousSourcemapOption="boolean"==typeof r.build.sourcemap?r.build.sourcemap:"hidden"===r.build.sourcemap),"boolean"==typeof r.build.sourcemap&&r.build.sourcemap?r.build.sourcemap=!0:r.build.sourcemap="hidden",X("Sourcemap option is set to '"+r.build.sourcemap+"'"))},async generateBundle(e,t){for(let e in s.installPluginContext(this),s.setupRollupChunks(t),t){let r=t[e],[i,o]=function(e,t){let{type:r}=e;if("asset"===r&&".js"===n.extname(e.fileName)){let n=e.fileName+".map";return n in t?[!0,n]:[!0,null]}let i="chunk"===r;return[i,i?e.sourcemapFileName:null]}(r,t),u=!!o;X("Processing chunk '"+r.fileName+"'.Chunk status: "+i+". Sourcemap status: "+u+"."),i&&o&&await s.addModule(r,o),!l.previousSourcemapOption&&i&&o&&Reflect.deleteProperty(t,o)}},async closeBundle(){switch(e.summary&&!a&&t.info(e4(s.modules)),X("Finish analyze bundle."+s.modules.length+" chunks found."),e.analyzerMode){case"json":{let t=n.join(u,e.fileName?`${e.fileName}.json`:"stats.json"),r=s.processModule();return U.writeFile(t,JSON.stringify(r,null,2),"utf8")}case"static":{let t=n.join(u,e.fileName?`${e.fileName}.html`:"stats.html"),r=s.processModule(),i=await et(r,{title:o,mode:"stat"});return U.writeFile(t,i,"utf8")}case"server":{let t=s.processModule(),{setup:n,port:l}=await eQ(("auto"===e.analyzerPort?0:e.analyzerPort)??8888);n(t,{title:o,mode:"stat"}),(e.openAnalyzer??!0)&&!e0&&function(e){let[t,n]=function(e){switch(e){case"linux":if(-1!==r.release().toLocaleLowerCase().indexOf("microsoft"))return["win32","cmd.exe"];return["linux","xdg-open"];case"win32":return["win32","cmd.exe"];case"darwin":return["darwin","open"];default:return[e,"xdg-open"]}}(r.platform());"win32"===t&&(e=["/c","start",'""'].concat(e=e.map(e=>e.replace(/[&^]/g,"^$&")))),i.spawn(n,e)}([`http://localhost:${l}`]);break}default:throw Error("Invalidate Option `analyzerMode`")}}}}exports.adapter=function(e){let t=["name","generateBundle","closeBundle","api"].reduce((t,n)=>(t[n]=e[n],t),{}),n=process.cwd(),{store:r}=t.api;return{...t,outputOptions(e){if(!r.hasSetSourcemapOption)return e.dir&&(n=e.dir),r.analyzerModule.workspaceRoot=er(n),"sourcemap"in e&&(r.previousSourcemapOption="boolean"==typeof e.sourcemap?e.sourcemap:"hidden"===e.sourcemap),"boolean"==typeof e.sourcemap&&e.sourcemap?e.sourcemap=!0:e.sourcemap="hidden",e}}},exports.analyzer=e8,exports.default=e8;
